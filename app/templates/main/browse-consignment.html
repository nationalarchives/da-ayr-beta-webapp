{% set breadcrumbs = {
    "everything":"Everything",
    "body": [breadcrumb_values[0]["transferring_body_id"], breadcrumb_values[1]["transferring_body"]],
    "series": [breadcrumb_values[2]["series_id"], breadcrumb_values[3]["series"]],
    "consignment": breadcrumb_values[4]["consignment_reference"]
} %}
<!-- BREAD CRUMB -->
{% with dict = breadcrumbs %}
    {% include "breadcrumb.html" %}
{% endwith %}
{% if view_type == "desktop" %}
    <form action="{{ url_for('main.browse') }}" method="get">
        <!-- SORT -->
        <div class="govuk-form-group sort-container__form">
            <input type="hidden"
                   name="consignment_id"
                   value="{{ filters['consignment_id'] }}">
            <div class="browse__sort-container">
                <label class="govuk-label" for="sort">Sort by</label>
                <select class="govuk-select govuk-select__sort-container-select"
                        id="sort"
                        name="sort">
                    <option value="closure_type-asc"
                            {% if sorting_orders["closure_type"] == "asc" %}selected{% endif %}>
                        Record status (closed first)
                    </option>
                    <option value="closure_type-desc"
                            {% if sorting_orders["closure_type"] == "desc" %}selected{% endif %}>
                        Record status (open first)
                    </option>
                    <option value="closure_expiry_date-asc"
                            {% if sorting_orders["closure_expiry_date"] == "asc" %}selected{% endif %}>
                        Closure expiry date (soonest first)
                    </option>
                    <option value="date_last_modified-desc"
                            {% if sorting_orders["date_last_modified"] == "desc" %}selected{% endif %}>
                        Last modified (most recent first)
                    </option>
                    <option value="date_last_modified-asc"
                            {% if sorting_orders["date_last_modified"] == "asc" %}selected{% endif %}>
                        Last modified (oldest first)
                    </option>
                    <option value="file_name-asc"
                            {% if sorting_orders["file_name"] == "asc" %}selected{% endif %}>
                        Record filename (A-Z)
                    </option>
                    <option value="file_name-desc"
                            {% if sorting_orders["file_name"] == "desc" %}selected{% endif %}>
                        Record filename (Z-A)
                    </option>
                </select>
                <button type="submit"
                        class="govuk-button govuk-button__sort-container-update-button"
                        id="sort-update-button"
                        data-module="govuk-button">Apply</button>
            </div>
        </div>
        <!-- TABLE -->
        <div class="govuk-grid-column-two-thirds browse-grid--two-thirds">
            {% if num_records_found > 0 %}
                <table class="govuk-table browse-grid__table">
                    <thead class="govuk-table__head">
                        <tr class="govuk-table__row">
                            <th scope="col" class="govuk-table__header">Last modified</th>
                            <th scope="col" class="govuk-table__header">Filename</th>
                            <th scope="col" class="govuk-table__header">Status</th>
                            <th scope="col" class="govuk-table__header">Closure start date</th>
                            <th scope="col" class="govuk-table__header">Closure period</th>
                        </tr>
                    </thead>
                    <tbody class="govuk-table__body">
                        {% for record in results %}
                            <tr class="govuk-table__row">
                                <td class="govuk-table__cell">{{ record["date_last_modified"] }}</td>
                                <td class="govuk-table__cell">
                                    <a href="{{ url_for('main.record', record_id=record['file_id']) }}">{{ record["file_name"] }}</a>
                                </td>
                                <td class="govuk-table__cell">
                                    <strong class="{% if record['closure_type'] == 'Open' %}govuk-tag govuk-tag--green{% elif record['closure_type'] == 'Closed' %}govuk-tag govuk-tag--red{% elif record['closure_type'] is none %}{% endif %}">
                                        {{ record['closure_type'] }}
                                    </strong>
                                </td>
                                <td class="govuk-table__cell">
                                    {% if record['closure_start_date'] %}
                                        {{ record['closure_start_date'] }}
                                    {% else %}
                                        -
                                    {% endif %}
                                </td>
                                <td class="govuk-table__cell">
                                    {% if record['closure_period'] %}
                                        {{ record['closure_period'] }} years
                                    {% else %}
                                        -
                                    {% endif %}
                                </td>
                            </tr>
                        {% endfor %}
                    </tbody>
                </table>
            {% endif %}
        </div>
        <!-- FILTERS -->
        <div class="govuk-grid-column-one-third govuk-grid-column-one-third--consignment-filters">
            <input type="hidden"
                   name="consignment_id"
                   value="{{ filters['consignment_id'] }}">
            <div class="consignment-filter-container">
                <div class="consignment-filter__header">
                    <h2 class="govuk-heading-m govuk-heading-m--consignment-filter-title">Filter</h2>
                    <img src="{{ url_for('static', filename='image/filter-icon.svg') }}"
                         height="32px"
                         width="32px"
                         class="consignment-filter__icon"
                         alt="filter-icon">
                </div>
                <!-- RECORD STATUS -->
                <h3 class="govuk-heading-s govuk-heading-s--consignment-filter">Record status</h3>
                <div class="govuk-form-group govuk-form-group__consignment-form-group">
                    <fieldset class="govuk-fieldset govuk-fieldset--record-status">
                        <div class="govuk-radios govuk-radios--small" data-module="govuk-radios">
                            <div class="govuk-radios__item govuk-radios__item--consignment-radio-buttons">
                                <input class="govuk-radios__input"
                                       id="recordStatus-closed"
                                       name="record_status"
                                       type="radio"
                                       value="closed"
                                       {% if user_filters["record_status"] == 'closed' %}checked{% endif %}>
                                <label class="govuk-label govuk-radios__label govuk-radios__label--consignment"
                                       for="record_status_closed">Closed only</label>
                            </div>
                            <div class="govuk-radios__item govuk-radios__item--consignment-radio-buttons">
                                <input class="govuk-radios__input"
                                       id="recordStatus-open"
                                       name="record_status"
                                       type="radio"
                                       value="open"
                                       {% if user_filters["record_status"] == 'open' %}checked{% endif %}>
                                <label class="govuk-label govuk-radios__label govuk-radios__label--consignment"
                                       for="record_status_open">Open only</label>
                            </div>
                            <div class="govuk-radios__item govuk-radios__item--consignment">
                                <input class="govuk-radios__input"
                                       id="recordStatus-all"
                                       name="record_status"
                                       type="radio"
                                       value="all"
                                       {% if user_filters["record_status"] == 'all' %}checked{% endif %}
                                       {% if not user_filters["record_status"] %}checked{% endif %}>
                                <label class="govuk-label govuk-radios__label govuk-radios__label--consignment"
                                       for="record_status_all">All records</label>
                            </div>
                        </div>
                    </fieldset>
                </div>
            </div>
            <!-- FILE TYPE -->
            <div class="consignment-filter-container consignment-filter-container--file-type">
                <div class="file-type-doc--container">
                    <h3 class="govuk-heading-s govuk-heading-s--file-type">File type</h3>
                    <p class="govuk-body govuk-body--file-type">(e.g. docx, pdf, tiff)</p>
                </div>
                <div class="govuk-form-group govuk-form-group--consignment-filter">
                    <input class="govuk-input govuk-!-width-full govuk-input--consignment-input"
                           id="full"
                           name="file_type"
                           type="text"
                           value="{% if user_filters['file_type'] %}{{ user_filters['file_type'] }}{% endif %}">
                </div>
            </div>
            <!-- DATES -->
            <div class="consignment-filter-container">
                <h3 class="govuk-heading-s govuk-heading-s--consignment-filter">Dates</h3>
                <div class="govuk-form-group govuk-form-group__consignment-form-group">
                    <fieldset class="govuk-fieldset">
                        <div class="govuk-radios govuk-radios--small" data-module="govuk-radios">
                            <div class="govuk-radios__item">
                                <input class="govuk-radios__input"
                                       id="fileLastModified"
                                       name="date_filter_field"
                                       type="radio"
                                       value="date_last_modified"
                                       {% if user_filters["date_filter_field"] == 'date_last_modified' %}checked{% endif %}>
                                <label class="govuk-label govuk-radios__label govuk-radios__label--consignment"
                                       for="fileLastModified">File last modified</label>
                            </div>
                            <div class="govuk-radios__item">
                                <input class="govuk-radios__input"
                                       id="closureExpiry"
                                       name="date_filter_field"
                                       type="radio"
                                       value="closure_expiry"
                                       {% if user_filters["date_filter_field"] == 'closure_expiry' %}checked{% endif %}>
                                <label class="govuk-label govuk-radios__label govuk-radios__label--consignment"
                                       for="closureExpiry">Closure expiry</label>
                            </div>
                        </div>
                    </fieldset>
                    <div class="consignment-filter-from-dates">
                        <p class="govuk-body govuk-body--consignment-date">Date from</p>
                        <fieldset class="govuk-fieldset govuk-fieldset--date-from"
                                  role="group"
                                  aria-describedby="date-from">
                            <div class="govuk-date-input govuk-date-input--consignment-date-to"
                                 id="date-from">
                                <div class="govuk-date-input__item govuk-date-input__item--consignment">
                                    <div class="govuk-form-group">
                                        <label class="govuk-label govuk-date-input__label filters-form__date__label"
                                               for="date-from-day">Day</label>
                                        <input class="govuk-input govuk-date-input__input govuk-input--width-2"
                                               id="date-from-day"
                                               name="date_from_day"
                                               type="text"
                                               inputmode="numeric"
                                               value="{% if user_filters['date_range'] %}{% if user_filters['date_range']['date_from'] %}{{ user_filters['date_range']['date_from'][0:2] }}{% endif %}{% endif %}">
                                    </div>
                                </div>
                                <div class="govuk-date-input__item govuk-date-input__item--consignment">
                                    <div class="govuk-form-group">
                                        <label class="govuk-label govuk-date-input__label filters-form__date__label"
                                               for="date-from-month">Month</label>
                                        <input class="govuk-input govuk-date-input__input govuk-input--width-2"
                                               id="date-from-month"
                                               name="date_from_month"
                                               type="text"
                                               inputmode="numeric"
                                               value="{% if user_filters['date_range'] %}{% if user_filters['date_range']['date_from'] %}{{ user_filters['date_range']['date_from'][3:5] }}{% endif %}{% endif %}">
                                    </div>
                                </div>
                                <div class="govuk-date-input__item govuk-date-input__item--consignment">
                                    <div class="govuk-form-group">
                                        <label class="govuk-label govuk-date-input__label filters-form__date__label"
                                               for="date-from-year">Year</label>
                                        <input class="govuk-input govuk-date-input__input govuk-input--width-4"
                                               id="date-from-year"
                                               name="date_from_year"
                                               type="text"
                                               inputmode="numeric"
                                               value="{% if user_filters['date_range'] %}{% if user_filters['date_range']['date_from'] %}{{ user_filters['date_range']['date_from'][6:10] }}{% endif %}{% endif %}">
                                    </div>
                                </div>
                            </div>
                        </fieldset>
                    </div>
                    <div class="consignment-filter-to-dates">
                        <p class="govuk-body govuk-body--consignment-date">To date</p>
                        <fieldset class="govuk-fieldset govuk-fieldset--date-to"
                                  role="group"
                                  aria-describedby="date-to">
                            <div class="govuk-date-input govuk-date-input--consignment-date-to"
                                 id="date-to">
                                <div class="govuk-date-input__item govuk-date-input__item--consignment">
                                    <div class="govuk-form-group">
                                        <label class="govuk-label govuk-date-input__label filters-form__date__label"
                                               for="date-to-day">Day</label>
                                        <input class="govuk-input govuk-date-input__input govuk-input--width-2"
                                               id="date-to-day"
                                               name="date_to_day"
                                               type="text"
                                               inputmode="numeric"
                                               value="{% if user_filters['date_range'] %}{% if user_filters['date_range']['date_to'] %}{{ user_filters['date_range']['date_to'][0:2] }}{% endif %}{% endif %}">
                                    </div>
                                </div>
                                <div class="govuk-date-input__item govuk-date-input__item--consignment">
                                    <div class="govuk-form-group">
                                        <label class="govuk-label govuk-date-input__label filters-form__date__label"
                                               for="date-to-month">Month</label>
                                        <input class="govuk-input govuk-date-input__input govuk-input--width-2"
                                               id="date-to-month"
                                               name="date_to_month"
                                               type="text"
                                               inputmode="numeric"
                                               value="{% if user_filters['date_range'] %}{% if user_filters['date_range']['date_to'] %}{{ user_filters['date_range']['date_to'][3:5] }}{% endif %}{% endif %}">
                                    </div>
                                </div>
                                <div class="govuk-date-input__item govuk-date-input__item--consignment">
                                    <div class="govuk-form-group">
                                        <label class="govuk-label govuk-date-input__label filters-form__date__label"
                                               for="date-to-year">Year</label>
                                        <input class="govuk-input govuk-date-input__input govuk-input--width-4"
                                               id="date-to-year"
                                               name="date_to_year"
                                               type="text"
                                               inputmode="numeric"
                                               value="{% if user_filters['date_range'] %}{% if user_filters['date_range']['date_to'] %}{{ user_filters['date_range']['date_to'][6:10] }}{% endif %}{% endif %}">
                                    </div>
                                </div>
                            </div>
                        </fieldset>
                    </div>
                </div>
                <div class="filters-form__buttons">
                    <button type="submit"
                            class="govuk-button govuk-button__consignment-filters-form-apply-button"
                            data-module="govuk-button">Apply filters</button>
                    <a class="govuk-link govuk-link--consignment-filter"
                       href="{{ url_for('main.browse', consignment_id=filters['consignment_id']) }}">Clear filters</a>
                </div>
            </div>
        </div>
        <!-- END FILTERS -->
    {% else %}
        <!-- MOBILE FILTERS -->
        <div class="mobile-filters">
            <details class="govuk-details">
                <summary class="govuk-mobile-details__summary">
                    <span class="govuk-mobile-details__summary-text">
                        Filter within browse
                        <img src="{{ url_for('static', filename='image/filter-icon.svg') }}"
                             height="32px"
                             width="32px"
                             class="browse-filter__icon"
                             alt="filter-icon">
                    </span>
                </summary>
                <div class="govuk-details__text govuk-mobile-details_text">
                    <div class="govuk-grid-column-one-third filters-form mobile-filters-form">
                        <div class="browse-filter-container">
                            <p class="govuk-body browse__body">Transferring body</p>
                            <div class="govuk-form-group filters-form__group filters-form__transferring-body-group">
                                <label class="govuk-label" for="browse_filter_transferring_body"></label>
                                <select class="govuk-select govuk-select__filters-form-transferring-body-select"
                                        id="browse_filter_transferring_body"
                                        name="sort">
                                    <option value="all" selected>Choose one...</option>
                                    <option value="arts">Arts Council England</option>
                                    <option value="food_standards_agency">Food Standards Agency</option>
                                    <option value="foreign_office">Foreign Office</option>
                                </select>
                            </div>
                        </div>
                        <div class="filters-form__series__container">
                            <p class="govuk-body browse__body">Series</p>
                            <div class="govuk-form-group filters-form__group filters-form__series-group">
                                <label class="govuk-label" for="browse_filter_series"></label>
                                <input class="govuk-input filters-form__series--input"
                                       id="browse_filter_series"
                                       name="width10"
                                       type="text">
                            </div>
                        </div>
                        <div class="filters-form__consignment-ref__container">
                            <p class="govuk-body browse__body">
                                Consignment <abbr title="reference">ref</abbr>
                            </p>
                            <div class="govuk-form-group filters-form__group filters-form__consignment-ref-group">
                                <label class="govuk-label" for="browse_filter_consignment-ref"></label>
                                <input class="govuk-input filters-form__consignment-ref--input"
                                       id="browse_filter_consignment-ref"
                                       name="width10"
                                       type="text">
                            </div>
                        </div>
                        <div class="filters-form__date__container">
                            <div class="govuk-form-group date-form filters-form__group filters-form__date-from-group">
                                <p class="govuk-body date-form browse__body filters-form__body-date">Date from</p>
                                <fieldset class="govuk-fieldset" role="group" aria-describedby="date-from">
                                    <div class="govuk-date-input" id="date-from">
                                        <div class="govuk-date-input__item">
                                            <div class="govuk-form-group">
                                                <input class="govuk-input govuk-date-input__input govuk-input--width-2"
                                                       id="date-from-day"
                                                       name="date-from-day"
                                                       type="text"
                                                       inputmode="numeric">
                                                <label class="govuk-label govuk-date-input__label filters-form__date__label"
                                                       for="date-from-day">(DD)</label>
                                            </div>
                                        </div>
                                        <div class="govuk-date-input__item">
                                            <div class="govuk-form-group">
                                                <input class="govuk-input govuk-date-input__input govuk-input--width-2"
                                                       id="date-from-month"
                                                       name="date-from-month"
                                                       type="text"
                                                       inputmode="numeric">
                                                <label class="govuk-label govuk-date-input__label filters-form__date__label"
                                                       for="date-from-month">(MM)</label>
                                            </div>
                                        </div>
                                        <div class="govuk-date-input__item">
                                            <div class="govuk-form-group">
                                                <input class="govuk-input govuk-date-input__input govuk-input--width-4"
                                                       id="date-from-year"
                                                       name="date-from-year"
                                                       type="text"
                                                       inputmode="numeric">
                                                <label class="govuk-label govuk-date-input__label filters-form__date__label"
                                                       for="date-from-year">(YYYY)</label>
                                            </div>
                                        </div>
                                    </div>
                                </fieldset>
                            </div>
                            <div class="govuk-form-group date-form filters-form__group filters-form__date-to-group">
                                <p class="govuk-body-m date-form browse__body filters-form__body-date">To date</p>
                                <fieldset class="govuk-fieldset" role="group" aria-describedby="date-to">
                                    <div class="govuk-date-input" id="date-to">
                                        <div class="govuk-date-input__item">
                                            <div class="govuk-form-group">
                                                <input class="govuk-input govuk-date-input__input govuk-input--width-2"
                                                       id="date-to-day"
                                                       name="date-to-day"
                                                       type="text"
                                                       inputmode="numeric">
                                                <label class="govuk-label govuk-date-input__label filters-form__date__label"
                                                       for="date-to-day">(DD)</label>
                                            </div>
                                        </div>
                                        <div class="govuk-date-input__item">
                                            <div class="govuk-form-group">
                                                <input class="govuk-input govuk-date-input__input govuk-input--width-2"
                                                       id="date-to-month"
                                                       name="date-to-month"
                                                       type="text"
                                                       inputmode="numeric">
                                                <label class="govuk-label govuk-date-input__label filters-form__date__label"
                                                       for="date-to-month">(MM)</label>
                                            </div>
                                        </div>
                                        <div class="govuk-date-input__item">
                                            <div class="govuk-form-group">
                                                <input class="govuk-input govuk-date-input__input govuk-input--width-4"
                                                       id="date-to-year"
                                                       name="date-to-year"
                                                       type="text"
                                                       inputmode="numeric">
                                                <label class="govuk-label govuk-date-input__label filters-form__date__label"
                                                       for="date-to-year">(YYYY)</label>
                                            </div>
                                        </div>
                                    </div>
                                </fieldset>
                            </div>
                            <div class="filters-form__buttons">
                                <button type="button"
                                        class="govuk-button govuk-button__filters-form-apply-button"
                                        data-module="govuk-button">Apply filters</button>
                                <button type="button"
                                        class="govuk-button__filters-form-clear-button"
                                        data-module="govuk-button">Clear filters</button>
                            </div>
                        </div>
                    </div>
                </div>
            </details>
        </div>
        <!-- MOBILE SORT -->
        <div class="govuk-form-group sort-container__form mobile-sort">
            <div class="browse__sort-container">
                <label class="govuk-label" for="sort">Sort by</label>
                <select class="govuk-select govuk-select__sort-container-select"
                        id="sort"
                        name="sort">
                    <option value="body-a">Transferring body (A to Z)</option>
                    <option value="body-b" selected>Transferring body (Z to A)</option>
                    <option value="series-a">Series (A to Z)</option>
                    <option value="series-b">Series (Z to A)</option>
                    <option value="date-first">Date record transferred (most recent first)</option>
                    <option value="date-last">Date record transferred (oldest first)</option>
                </select>
                <button class="govuk-button govuk-button__sort-container-update-button"
                        id="sort-update-button"
                        data-module="govuk-button">Apply</button>
            </div>
        </div>
        <!-- MOBILE TABLE -->
        <table class="govuk-table govuk-mobile-table">
            <thead class="govuk-table__head govuk-mobile-table__head-border">
                <tr class="govuk-table__row">
                    <th scope="col" class="govuk-table__header">Series / Last consignment transferred</th>
                    <th scope="col" class="govuk-table__header govuk-table__header__right">Records in series</th>
                    <th scope="col" class="govuk-table__header govuk-table__header__right">Consignments within series</th>
                </tr>
            </thead>
            <tbody class="govuk-table__body">
                {% for record in results %}
                    <tr class="govuk-table__row">
                        <td class="govuk-table__cell">
                            <div class="browse__table__series-row">
                                <a href="{{ url_for('main.browse', series_id=record['series_id']) }}">{{ record["series"]
                                }}</a>
                            </div>
                            <div>{{ record["last_record_transferred"] }}</div>
                        </td>
                        <td class="govuk-table__cell">
                            <div class="browse__table__series-row empty-cell">-</div>
                            <div class="right-align">{{ record["records_held"] }}</div>
                        </td>
                        <td class="govuk-table__cell">
                            <div class="browse__table__series-row right-align empty-cell">-</div>
                            <div class="right-align">{{ record["consignment_in_series"] }}</div>
                        </td>
                    </tr>
                {% endfor %}
            </tbody>
        </table>
    </form>
{% endif %}
